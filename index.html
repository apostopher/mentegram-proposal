<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mentegram API Migration Plan</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary: #1a1a2e;
        --accent: #4f46e5;
        --accent-light: #eef2ff;
        --accent-mid: #c7d2fe;
        --text: #1e293b;
        --text-secondary: #64748b;
        --border: #e2e8f0;
        --bg: #ffffff;
        --bg-subtle: #f8fafc;
        --success: #059669;
        --success-light: #ecfdf5;
        --warning: #d97706;
        --warning-light: #fffbeb;
        --danger: #dc2626;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          "Inter",
          -apple-system,
          BlinkMacSystemFont,
          sans-serif;
        color: var(--text);
        background: var(--bg);
        line-height: 1.6;
        -webkit-font-smoothing: antialiased;
      }

      .container {
        max-width: 960px;
        margin: 0 auto;
        padding: 0 32px;
      }

      /* Header */
      .header {
        background: var(--primary);
        color: white;
        padding: 64px 0 56px;
      }

      .header-badge {
        display: inline-block;
        font-size: 11px;
        font-weight: 600;
        letter-spacing: 1.5px;
        text-transform: uppercase;
        background: rgba(255, 255, 255, 0.12);
        padding: 6px 14px;
        border-radius: 100px;
        margin-bottom: 24px;
      }

      .header h1 {
        font-size: 40px;
        font-weight: 800;
        line-height: 1.15;
        margin-bottom: 12px;
        letter-spacing: -0.5px;
      }

      .header p {
        font-size: 18px;
        font-weight: 300;
        color: rgba(255, 255, 255, 0.7);
        max-width: 600px;
      }

      .header-meta {
        display: flex;
        gap: 32px;
        margin-top: 32px;
        padding-top: 32px;
        border-top: 1px solid rgba(255, 255, 255, 0.12);
      }

      .header-meta-item {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .header-meta-label {
        font-size: 11px;
        font-weight: 600;
        letter-spacing: 1px;
        text-transform: uppercase;
        color: rgba(255, 255, 255, 0.45);
      }

      .header-meta-value {
        font-size: 15px;
        font-weight: 500;
        color: rgba(255, 255, 255, 0.9);
      }

      /* Summary Cards */
      .summary {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 1px;
        background: var(--border);
        border: 1px solid var(--border);
        border-radius: 12px;
        overflow: hidden;
        margin-top: -32px;
        position: relative;
        z-index: 1;
      }

      .summary-card {
        background: var(--bg);
        padding: 24px;
        text-align: center;
      }

      .summary-card-value {
        font-size: 32px;
        font-weight: 800;
        color: var(--accent);
        letter-spacing: -1px;
      }

      .summary-card-label {
        font-size: 12px;
        font-weight: 500;
        color: var(--text-secondary);
        margin-top: 4px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      /* Section */
      .section {
        padding: 56px 0;
        border-bottom: 1px solid var(--border);
      }

      .section:last-child {
        border-bottom: none;
      }

      .section-label {
        font-size: 11px;
        font-weight: 700;
        letter-spacing: 1.5px;
        text-transform: uppercase;
        color: var(--accent);
        margin-bottom: 8px;
      }

      .section h2 {
        font-size: 28px;
        font-weight: 700;
        color: var(--primary);
        margin-bottom: 8px;
        letter-spacing: -0.3px;
      }

      .section-desc {
        font-size: 15px;
        color: var(--text-secondary);
        margin-bottom: 32px;
        max-width: 680px;
      }

      /* Tech Stack */
      .stack-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
      }

      .stack-item {
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 16px 20px;
        background: var(--bg-subtle);
        border-radius: 10px;
        border: 1px solid var(--border);
      }

      .stack-item-layer {
        font-size: 12px;
        font-weight: 600;
        color: var(--text-secondary);
        min-width: 90px;
        text-transform: uppercase;
        letter-spacing: 0.3px;
      }

      .stack-item-tech {
        font-size: 15px;
        font-weight: 600;
        color: var(--text);
      }

      /* Current State */
      .current-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
      }

      .current-item {
        padding: 20px;
        background: var(--bg-subtle);
        border-radius: 10px;
        border: 1px solid var(--border);
      }

      .current-item h4 {
        font-size: 13px;
        font-weight: 600;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 8px;
      }

      .current-item p {
        font-size: 15px;
        font-weight: 500;
      }

      .current-item .old {
        color: var(--danger);
        text-decoration: line-through;
        opacity: 0.6;
      }

      .current-item .new {
        color: var(--success);
      }

      .current-item .arrow {
        color: var(--text-secondary);
        margin: 0 8px;
      }

      /* Phase Timeline */
      .phase {
        position: relative;
        padding-left: 40px;
        padding-bottom: 40px;
      }

      .phase:last-child {
        padding-bottom: 0;
      }

      .phase::before {
        content: "";
        position: absolute;
        left: 15px;
        top: 0;
        bottom: 0;
        width: 2px;
        background: var(--border);
      }

      .phase:last-child::before {
        display: none;
      }

      .phase-dot {
        position: absolute;
        left: 6px;
        top: 4px;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: var(--accent);
        border: 3px solid var(--bg);
        box-shadow: 0 0 0 2px var(--accent);
      }

      .phase-dot.critical {
        background: var(--warning);
        box-shadow: 0 0 0 2px var(--warning);
      }

      .phase-header {
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        margin-bottom: 12px;
      }

      .phase-title {
        font-size: 18px;
        font-weight: 700;
        color: var(--primary);
      }

      .phase-number {
        font-size: 13px;
        font-weight: 600;
        color: var(--accent);
        margin-right: 8px;
      }

      .phase-effort {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        font-size: 13px;
        font-weight: 600;
        color: var(--accent);
        background: var(--accent-light);
        padding: 4px 12px;
        border-radius: 100px;
        white-space: nowrap;
        flex-shrink: 0;
      }

      .phase-effort.critical {
        color: var(--warning);
        background: var(--warning-light);
      }

      .phase-desc {
        font-size: 14px;
        color: var(--text-secondary);
        margin-bottom: 16px;
      }

      .phase-items {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }

      .phase-tag {
        font-size: 12px;
        font-weight: 500;
        color: var(--text-secondary);
        background: var(--bg-subtle);
        border: 1px solid var(--border);
        padding: 4px 10px;
        border-radius: 6px;
      }

      /* Effort Table */
      .effort-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 8px;
      }

      .effort-table th {
        text-align: left;
        font-size: 11px;
        font-weight: 700;
        letter-spacing: 1px;
        text-transform: uppercase;
        color: var(--text-secondary);
        padding: 12px 16px;
        border-bottom: 2px solid var(--border);
      }

      .effort-table td {
        padding: 14px 16px;
        border-bottom: 1px solid var(--border);
        font-size: 14px;
      }

      .effort-table tr:last-child td {
        border-bottom: none;
      }

      .effort-table .phase-num {
        font-weight: 700;
        color: var(--accent);
        font-size: 13px;
        width: 60px;
      }

      .effort-table .scope-name {
        font-weight: 600;
      }

      .effort-table .effort-days {
        font-weight: 700;
        color: var(--accent);
        text-align: right;
        white-space: nowrap;
      }

      .effort-table .detail-text {
        color: var(--text-secondary);
        font-size: 13px;
        text-align: right;
      }

      .effort-table tfoot td {
        border-top: 2px solid var(--primary);
        font-weight: 700;
        font-size: 15px;
        padding-top: 16px;
      }

      .effort-table tfoot .effort-days {
        color: var(--primary);
        font-size: 16px;
      }

      /* Week plan */
      .week-grid {
        display: grid;
        grid-template-columns: 80px 1fr;
        gap: 0;
        border: 1px solid var(--border);
        border-radius: 12px;
        overflow: hidden;
      }

      .week-label {
        background: var(--primary);
        color: white;
        font-size: 13px;
        font-weight: 700;
        padding: 18px 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .week-content {
        padding: 18px 20px;
        font-size: 14px;
        color: var(--text);
        border-bottom: 1px solid var(--border);
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .week-content:last-child,
      .week-label:last-child {
        border-bottom: none;
      }

      .week-phases {
        display: flex;
        gap: 6px;
        flex-wrap: wrap;
      }

      .week-phase-tag {
        font-size: 11px;
        font-weight: 600;
        background: var(--accent-light);
        color: var(--accent);
        padding: 3px 8px;
        border-radius: 4px;
      }

      .week-desc {
        font-weight: 500;
      }

      /* Progress bar */
      .bar-container {
        display: flex;
        height: 12px;
        border-radius: 6px;
        overflow: hidden;
        background: var(--border);
        margin-top: 8px;
        margin-bottom: 8px;
      }

      .bar-segment {
        height: 100%;
        position: relative;
      }

      .bar-legend {
        display: flex;
        gap: 24px;
        margin-top: 12px;
        flex-wrap: wrap;
      }

      .bar-legend-item {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 12px;
        font-weight: 500;
        color: var(--text-secondary);
      }

      .bar-legend-dot {
        width: 10px;
        height: 10px;
        border-radius: 3px;
      }

      /* Notes */
      .note-box {
        background: var(--accent-light);
        border-left: 3px solid var(--accent);
        padding: 16px 20px;
        border-radius: 0 8px 8px 0;
        margin-top: 24px;
      }

      .note-box p {
        font-size: 14px;
        color: var(--text);
      }

      .note-box strong {
        font-weight: 600;
      }

      /* Footer */
      .footer {
        padding: 40px 0;
        text-align: center;
        color: var(--text-secondary);
        font-size: 13px;
      }

      .footer-line {
        width: 48px;
        height: 3px;
        background: var(--border);
        border-radius: 2px;
        margin: 0 auto 16px;
      }

      /* Print */
      @media print {
        .header {
          padding: 32px 0 24px;
        }
        .section {
          padding: 32px 0;
        }
        .phase {
          padding-bottom: 24px;
        }
        body {
          font-size: 13px;
        }
        .summary {
          margin-top: -16px;
        }
      }

      @media (max-width: 640px) {
        .summary {
          grid-template-columns: repeat(2, 1fr);
        }
        .stack-grid {
          grid-template-columns: 1fr;
        }
        .current-grid {
          grid-template-columns: 1fr;
        }
        .header h1 {
          font-size: 28px;
        }
        .header-meta {
          flex-wrap: wrap;
          gap: 20px;
        }
        .week-grid {
          grid-template-columns: 64px 1fr;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <div class="header">
      <div class="container">
        <div class="header-badge">Migration Plan</div>
        <h1>Mentegram API Modernization</h1>
        <p>
          Complete migration from legacy PHP/MySQL to a modern Next.js stack
          with Clerk, Drizzle ORM, and Vercel infrastructure.
        </p>
        <div class="header-meta">
          <div class="header-meta-item">
            <span class="header-meta-label">Prepared</span>
            <span class="header-meta-value">February 2026</span>
          </div>
          <div class="header-meta-item">
            <span class="header-meta-label">Duration</span>
            <span class="header-meta-value">5 &ndash; 7 Weeks</span>
          </div>
          <div class="header-meta-item">
            <span class="header-meta-label">Effort</span>
            <span class="header-meta-value">27 &ndash; 35 Dev Days</span>
          </div>
          <div class="header-meta-item">
            <span class="header-meta-label">Status</span>
            <span class="header-meta-value">Proposed</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Summary Cards -->
    <div class="container">
      <div class="summary">
        <div class="summary-card">
          <div class="summary-card-value">52</div>
          <div class="summary-card-label">Database Tables</div>
        </div>
        <div class="summary-card">
          <div class="summary-card-value">~165</div>
          <div class="summary-card-label">API Endpoints</div>
        </div>
        <div class="summary-card">
          <div class="summary-card-value">13</div>
          <div class="summary-card-label">Phases</div>
        </div>
        <div class="summary-card">
          <div class="summary-card-value">7</div>
          <div class="summary-card-label">Cron Jobs</div>
        </div>
      </div>
    </div>

    <!-- Current â†’ New -->
    <div class="container">
      <div class="section">
        <div class="section-label">Transformation</div>
        <h2>Current State &rarr; Target State</h2>
        <p class="section-desc">
          Every layer of the stack is being modernized for better developer
          experience, performance, and scalability.
        </p>
        <div class="current-grid">
          <div class="current-item">
            <h4>Language</h4>
            <p>
              <span class="old">PHP 5.5</span><span class="arrow">&rarr;</span
              ><span class="new">TypeScript</span>
            </p>
          </div>
          <div class="current-item">
            <h4>Framework</h4>
            <p>
              <span class="old">Custom MVC</span
              ><span class="arrow">&rarr;</span
              ><span class="new">Next.js 14+ (App Router)</span>
            </p>
          </div>
          <div class="current-item">
            <h4>Database</h4>
            <p>
              <span class="old">MySQL (raw PDO)</span
              ><span class="arrow">&rarr;</span
              ><span class="new">PostgreSQL (Drizzle ORM)</span>
            </p>
          </div>
          <div class="current-item">
            <h4>Authentication</h4>
            <p>
              <span class="old">Custom token system</span
              ><span class="arrow">&rarr;</span><span class="new">Clerk</span>
            </p>
          </div>
          <div class="current-item">
            <h4>Hosting</h4>
            <p>
              <span class="old">Google App Engine</span
              ><span class="arrow">&rarr;</span><span class="new">Vercel</span>
            </p>
          </div>
          <div class="current-item">
            <h4>Document Storage</h4>
            <p>
              <span class="old">TrueVault</span><span class="arrow">&rarr;</span
              ><span class="new">Encrypted JSONB</span>
            </p>
          </div>
          <div class="current-item">
            <h4>File Storage</h4>
            <p>
              <span class="old">Google Cloud Storage</span
              ><span class="arrow">&rarr;</span
              ><span class="new">Vercel Blob / S3</span>
            </p>
          </div>
          <div class="current-item">
            <h4>Cron Jobs</h4>
            <p>
              <span class="old">App Engine Cron</span
              ><span class="arrow">&rarr;</span
              ><span class="new">Vercel Cron</span>
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Target Stack -->
    <div class="container">
      <div class="section">
        <div class="section-label">Architecture</div>
        <h2>Target Technology Stack</h2>
        <p class="section-desc">
          A modern, fully-managed infrastructure with minimal operational
          overhead.
        </p>
        <div class="stack-grid">
          <div class="stack-item">
            <span class="stack-item-layer">Framework</span>
            <span class="stack-item-tech">Next.js 14+ (App Router)</span>
          </div>
          <div class="stack-item">
            <span class="stack-item-layer">Language</span>
            <span class="stack-item-tech">TypeScript</span>
          </div>
          <div class="stack-item">
            <span class="stack-item-layer">Auth</span>
            <span class="stack-item-tech">Clerk</span>
          </div>
          <div class="stack-item">
            <span class="stack-item-layer">Database</span>
            <span class="stack-item-tech">Vercel Postgres (Neon)</span>
          </div>
          <div class="stack-item">
            <span class="stack-item-layer">ORM</span>
            <span class="stack-item-tech">Drizzle</span>
          </div>
          <div class="stack-item">
            <span class="stack-item-layer">Validation</span>
            <span class="stack-item-tech">Zod</span>
          </div>
          <div class="stack-item">
            <span class="stack-item-layer">Payments</span>
            <span class="stack-item-tech">Stripe + PayPal</span>
          </div>
          <div class="stack-item">
            <span class="stack-item-layer">Email</span>
            <span class="stack-item-tech">SendGrid</span>
          </div>
          <div class="stack-item">
            <span class="stack-item-layer">Hosting</span>
            <span class="stack-item-tech">Vercel</span>
          </div>
          <div class="stack-item">
            <span class="stack-item-layer">Cron</span>
            <span class="stack-item-tech">Vercel Cron</span>
          </div>
          <div class="stack-item">
            <span class="stack-item-layer">Storage</span>
            <span class="stack-item-tech">Vercel Blob</span>
          </div>
          <div class="stack-item">
            <span class="stack-item-layer">Encryption</span>
            <span class="stack-item-tech">AES-256-GCM (App Layer)</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Phases -->
    <div class="container">
      <div class="section">
        <div class="section-label">Execution</div>
        <h2>Migration Phases</h2>
        <p class="section-desc">
          The migration is broken into 13 sequential phases, each delivering a
          testable increment of functionality.
        </p>

        <!-- Phase 0 -->
        <div class="phase">
          <div class="phase-dot"></div>
          <div class="phase-header">
            <div class="phase-title">
              <span class="phase-number">Phase 0</span> Project Setup &amp;
              Infrastructure
            </div>
            <span class="phase-effort">1 day</span>
          </div>
          <p class="phase-desc">
            Initialize the Next.js project, configure Drizzle ORM with Vercel
            Postgres, set up Clerk authentication project, configure environment
            variables, and establish the CI/CD pipeline.
          </p>
          <div class="phase-items">
            <span class="phase-tag">Next.js init</span>
            <span class="phase-tag">Drizzle config</span>
            <span class="phase-tag">Clerk project</span>
            <span class="phase-tag">Vercel deploy</span>
            <span class="phase-tag">Docker Compose</span>
            <span class="phase-tag">ESLint + Prettier</span>
          </div>
        </div>

        <!-- Phase 1 -->
        <div class="phase">
          <div class="phase-dot"></div>
          <div class="phase-header">
            <div class="phase-title">
              <span class="phase-number">Phase 1</span> Database Schema
            </div>
            <span class="phase-effort">1 &ndash; 2 days</span>
          </div>
          <p class="phase-desc">
            Translate all 52 MySQL tables to Drizzle/PostgreSQL schemas. Convert
            MySQL-specific types (BIGINT timestamps, BINARY hashes, LONGTEXT
            JSON) to native Postgres equivalents. Generate and run migrations.
          </p>
          <div class="phase-items">
            <span class="phase-tag">52 tables</span>
            <span class="phase-tag">Drizzle schemas</span>
            <span class="phase-tag">Indexes</span>
            <span class="phase-tag">Foreign keys</span>
            <span class="phase-tag">Type conversions</span>
            <span class="phase-tag">Seed data</span>
          </div>
        </div>

        <!-- Phase 2 -->
        <div class="phase">
          <div class="phase-dot"></div>
          <div class="phase-header">
            <div class="phase-title">
              <span class="phase-number">Phase 2</span> Authentication &amp;
              Authorization
            </div>
            <span class="phase-effort">1 day</span>
          </div>
          <p class="phase-desc">
            Configure Clerk for three user types (admin, therapist, client). Set
            up webhook sync to database, role-based middleware, and organization
            support. This eliminates ~15 legacy auth endpoints and 7 token
            tables.
          </p>
          <div class="phase-items">
            <span class="phase-tag">Clerk middleware</span>
            <span class="phase-tag">Role-based access</span>
            <span class="phase-tag">Webhook sync</span>
            <span class="phase-tag">Org support</span>
            <span class="phase-tag">Kiosk mode</span>
          </div>
        </div>

        <!-- Phase 3 -->
        <div class="phase">
          <div class="phase-dot"></div>
          <div class="phase-header">
            <div class="phase-title">
              <span class="phase-number">Phase 3</span> Core Entity CRUD
            </div>
            <span class="phase-effort">3 &ndash; 4 days</span>
          </div>
          <p class="phase-desc">
            Build complete CRUD operations for the four core entities:
            Therapists, Clients, Organizations, and Admins. Includes client
            management, organization membership, therapist-client relationships,
            and admin controls.
          </p>
          <div class="phase-items">
            <span class="phase-tag">~45 endpoints</span>
            <span class="phase-tag">Therapist CRUD</span>
            <span class="phase-tag">Client CRUD</span>
            <span class="phase-tag">Organization CRUD</span>
            <span class="phase-tag">Admin CRUD</span>
            <span class="phase-tag">Membership mgmt</span>
          </div>
        </div>

        <!-- Phase 4 -->
        <div class="phase">
          <div class="phase-dot critical"></div>
          <div class="phase-header">
            <div class="phase-title">
              <span class="phase-number">Phase 4</span> Clinical Data &mdash;
              Questionnaires &amp; Answers
            </div>
            <span class="phase-effort critical">5 &ndash; 7 days</span>
          </div>
          <p class="phase-desc">
            The most complex phase. Port the full questionnaire lifecycle:
            templates, assignment, answer submission, scoring algorithms,
            measurements, improvement tracking, protocols, and clinical notes.
            Includes K5, K10, and PMHC report logic.
          </p>
          <div class="phase-items">
            <span class="phase-tag">~32 endpoints</span>
            <span class="phase-tag">Templates</span>
            <span class="phase-tag">Questionnaires</span>
            <span class="phase-tag">Answers</span>
            <span class="phase-tag">Scoring engine</span>
            <span class="phase-tag">Measurements</span>
            <span class="phase-tag">Protocols</span>
            <span class="phase-tag">Notes</span>
          </div>
        </div>

        <!-- Phase 5 -->
        <div class="phase">
          <div class="phase-dot critical"></div>
          <div class="phase-header">
            <div class="phase-title">
              <span class="phase-number">Phase 5</span> TrueVault Replacement
            </div>
            <span class="phase-effort critical">2 &ndash; 3 days</span>
          </div>
          <p class="phase-desc">
            Replace the TrueVault encrypted document storage with
            application-level AES-256-GCM encryption stored in PostgreSQL JSONB
            columns. Build encryption service and migrate all document
            references.
          </p>
          <div class="phase-items">
            <span class="phase-tag">Encryption service</span>
            <span class="phase-tag">JSONB migration</span>
            <span class="phase-tag">Key management</span>
            <span class="phase-tag">Client profiles</span>
            <span class="phase-tag">Answer data</span>
            <span class="phase-tag">Note content</span>
          </div>
        </div>

        <!-- Phase 6 -->
        <div class="phase">
          <div class="phase-dot"></div>
          <div class="phase-header">
            <div class="phase-title">
              <span class="phase-number">Phase 6</span> Payments &amp; Billing
            </div>
            <span class="phase-effort">2 &ndash; 3 days</span>
          </div>
          <p class="phase-desc">
            Integrate Stripe SDK for subscription management, payment methods,
            and webhook handling. Port PayPal IPN handler. Implement invoice
            generation and account billing log.
          </p>
          <div class="phase-items">
            <span class="phase-tag">~10 endpoints</span>
            <span class="phase-tag">Stripe subscriptions</span>
            <span class="phase-tag">Webhooks</span>
            <span class="phase-tag">PayPal IPN</span>
            <span class="phase-tag">Invoices</span>
          </div>
        </div>

        <!-- Phase 7 -->
        <div class="phase">
          <div class="phase-dot"></div>
          <div class="phase-header">
            <div class="phase-title">
              <span class="phase-number">Phase 7</span> Scheduling, Screening
              &amp; Notifications
            </div>
            <span class="phase-effort">1 &ndash; 2 days</span>
          </div>
          <p class="phase-desc">
            Build appointment scheduling CRUD, screening device pairing and
            management flows, and push notification infrastructure using
            existing device tokens.
          </p>
          <div class="phase-items">
            <span class="phase-tag">~12 endpoints</span>
            <span class="phase-tag">Appointments</span>
            <span class="phase-tag">Device pairing</span>
            <span class="phase-tag">Kiosk sessions</span>
            <span class="phase-tag">Push notifications</span>
          </div>
        </div>

        <!-- Phase 8 -->
        <div class="phase">
          <div class="phase-dot critical"></div>
          <div class="phase-header">
            <div class="phase-title">
              <span class="phase-number">Phase 8</span> Downloads, Reports &amp;
              Storage
            </div>
            <span class="phase-effort critical">3 &ndash; 4 days</span>
          </div>
          <p class="phase-desc">
            Implement file upload/download via Vercel Blob, PDF generation for
            questionnaires and invoices, and all report generation endpoints
            including organization-level PMHC and date-range reports.
          </p>
          <div class="phase-items">
            <span class="phase-tag">~12 endpoints</span>
            <span class="phase-tag">File uploads</span>
            <span class="phase-tag">PDF generation</span>
            <span class="phase-tag">Report export</span>
            <span class="phase-tag">Org reports</span>
          </div>
        </div>

        <!-- Phase 9 -->
        <div class="phase">
          <div class="phase-dot"></div>
          <div class="phase-header">
            <div class="phase-title">
              <span class="phase-number">Phase 9</span> Background Jobs
            </div>
            <span class="phase-effort">0.5 days</span>
          </div>
          <p class="phase-desc">
            Configure Vercel Cron for 7 recurring jobs: reminders (every 5 min),
            scheduling checks (every 5 min), hourly tracking aggregation, daily
            tracking, customer care emails, tracking alerts, and tag report
            generation.
          </p>
          <div class="phase-items">
            <span class="phase-tag">7 cron routes</span>
            <span class="phase-tag">vercel.json config</span>
            <span class="phase-tag">CRON_SECRET auth</span>
          </div>
        </div>

        <!-- Phase 10 -->
        <div class="phase">
          <div class="phase-dot"></div>
          <div class="phase-header">
            <div class="phase-title">
              <span class="phase-number">Phase 10</span> Tracking &amp;
              Analytics
            </div>
            <span class="phase-effort">0.5 days</span>
          </div>
          <p class="phase-desc">
            Implement API request logging middleware, usage tracking with hourly
            and daily aggregation, client/therapist view tracking, and error
            logging integration.
          </p>
          <div class="phase-items">
            <span class="phase-tag">Request logging</span>
            <span class="phase-tag">Usage tracking</span>
            <span class="phase-tag">View tracking</span>
            <span class="phase-tag">Error monitoring</span>
          </div>
        </div>

        <!-- Phase 11 -->
        <div class="phase">
          <div class="phase-dot critical"></div>
          <div class="phase-header">
            <div class="phase-title">
              <span class="phase-number">Phase 11</span> Data Migration
            </div>
            <span class="phase-effort critical">3 &ndash; 4 days</span>
          </div>
          <p class="phase-desc">
            Write TypeScript migration scripts to extract data from MySQL,
            transform types, decrypt TrueVault documents, bulk-import users to
            Clerk, and load everything into PostgreSQL. Includes validation,
            dry-run on staging, and cutover planning.
          </p>
          <div class="phase-items">
            <span class="phase-tag">MySQL export</span>
            <span class="phase-tag">Type transforms</span>
            <span class="phase-tag">Clerk bulk import</span>
            <span class="phase-tag">TrueVault decrypt</span>
            <span class="phase-tag">Validation scripts</span>
            <span class="phase-tag">Staging dry-run</span>
          </div>
        </div>

        <!-- Phase 12 -->
        <div class="phase">
          <div class="phase-dot"></div>
          <div class="phase-header">
            <div class="phase-title">
              <span class="phase-number">Phase 12</span> QA, Hardening &amp;
              Launch
            </div>
            <span class="phase-effort">3 &ndash; 4 days</span>
          </div>
          <p class="phase-desc">
            End-to-end testing of all flows, API parity validation against the
            legacy system, rate limiting, security audit (OWASP top 10),
            performance testing, monitoring setup, and production launch.
          </p>
          <div class="phase-items">
            <span class="phase-tag">E2E testing</span>
            <span class="phase-tag">Parity checks</span>
            <span class="phase-tag">Security audit</span>
            <span class="phase-tag">Performance</span>
            <span class="phase-tag">Monitoring</span>
            <span class="phase-tag">Go-live</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Effort Breakdown -->
    <div class="container">
      <div class="section">
        <div class="section-label">Estimation</div>
        <h2>Effort Breakdown</h2>
        <p class="section-desc">
          Estimated developer-days for each phase based on scope, complexity,
          and AI-assisted development.
        </p>

        <!-- Visual bar -->
        <div class="bar-container">
          <div
            class="bar-segment"
            style="width: 3.2%; background: #6366f1"
            title="Phase 0"
          ></div>
          <div
            class="bar-segment"
            style="width: 4.8%; background: #818cf8"
            title="Phase 1"
          ></div>
          <div
            class="bar-segment"
            style="width: 3.2%; background: #a5b4fc"
            title="Phase 2"
          ></div>
          <div
            class="bar-segment"
            style="width: 11.3%; background: #6366f1"
            title="Phase 3"
          ></div>
          <div
            class="bar-segment"
            style="width: 19.4%; background: #f59e0b"
            title="Phase 4"
          ></div>
          <div
            class="bar-segment"
            style="width: 8.1%; background: #f59e0b"
            title="Phase 5"
          ></div>
          <div
            class="bar-segment"
            style="width: 8.1%; background: #818cf8"
            title="Phase 6"
          ></div>
          <div
            class="bar-segment"
            style="width: 4.8%; background: #a5b4fc"
            title="Phase 7"
          ></div>
          <div
            class="bar-segment"
            style="width: 11.3%; background: #f59e0b"
            title="Phase 8"
          ></div>
          <div
            class="bar-segment"
            style="width: 1.6%; background: #c7d2fe"
            title="Phase 9"
          ></div>
          <div
            class="bar-segment"
            style="width: 1.6%; background: #c7d2fe"
            title="Phase 10"
          ></div>
          <div
            class="bar-segment"
            style="width: 11.3%; background: #f59e0b"
            title="Phase 11"
          ></div>
          <div
            class="bar-segment"
            style="width: 11.3%; background: #6366f1"
            title="Phase 12"
          ></div>
        </div>
        <div class="bar-legend">
          <div class="bar-legend-item">
            <span class="bar-legend-dot" style="background: #6366f1"></span
            >Infrastructure &amp; QA
          </div>
          <div class="bar-legend-item">
            <span class="bar-legend-dot" style="background: #818cf8"></span>CRUD
            &amp; Integrations
          </div>
          <div class="bar-legend-item">
            <span class="bar-legend-dot" style="background: #f59e0b"></span
            >Complex / Critical Path
          </div>
          <div class="bar-legend-item">
            <span class="bar-legend-dot" style="background: #c7d2fe"></span
            >Lightweight
          </div>
        </div>

        <table class="effort-table" style="margin-top: 32px">
          <thead>
            <tr>
              <th>Phase</th>
              <th>Scope</th>
              <th style="text-align: right">Coverage</th>
              <th style="text-align: right">Effort</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="phase-num">0</td>
              <td class="scope-name">Project Setup &amp; Infrastructure</td>
              <td class="detail-text">&mdash;</td>
              <td class="effort-days">1 day</td>
            </tr>
            <tr>
              <td class="phase-num">1</td>
              <td class="scope-name">Database Schema (Drizzle)</td>
              <td class="detail-text">52 tables</td>
              <td class="effort-days">1 &ndash; 2 days</td>
            </tr>
            <tr>
              <td class="phase-num">2</td>
              <td class="scope-name">Authentication (Clerk)</td>
              <td class="detail-text">Eliminates ~15 endpoints</td>
              <td class="effort-days">1 day</td>
            </tr>
            <tr>
              <td class="phase-num">3</td>
              <td class="scope-name">Core Entity CRUD</td>
              <td class="detail-text">~45 endpoints</td>
              <td class="effort-days">3 &ndash; 4 days</td>
            </tr>
            <tr>
              <td class="phase-num">4</td>
              <td class="scope-name">
                Clinical Data &mdash; Questionnaires &amp; Answers
              </td>
              <td class="detail-text">~32 endpoints</td>
              <td class="effort-days">5 &ndash; 7 days</td>
            </tr>
            <tr>
              <td class="phase-num">5</td>
              <td class="scope-name">TrueVault Replacement</td>
              <td class="detail-text">Encryption service</td>
              <td class="effort-days">2 &ndash; 3 days</td>
            </tr>
            <tr>
              <td class="phase-num">6</td>
              <td class="scope-name">Payments &amp; Billing</td>
              <td class="detail-text">~10 endpoints</td>
              <td class="effort-days">2 &ndash; 3 days</td>
            </tr>
            <tr>
              <td class="phase-num">7</td>
              <td class="scope-name">
                Scheduling, Screening &amp; Notifications
              </td>
              <td class="detail-text">~12 endpoints</td>
              <td class="effort-days">1 &ndash; 2 days</td>
            </tr>
            <tr>
              <td class="phase-num">8</td>
              <td class="scope-name">Downloads, Reports &amp; Storage</td>
              <td class="detail-text">~12 endpoints</td>
              <td class="effort-days">3 &ndash; 4 days</td>
            </tr>
            <tr>
              <td class="phase-num">9</td>
              <td class="scope-name">Background Jobs (Vercel Cron)</td>
              <td class="detail-text">7 cron routes</td>
              <td class="effort-days">0.5 days</td>
            </tr>
            <tr>
              <td class="phase-num">10</td>
              <td class="scope-name">Tracking &amp; Analytics</td>
              <td class="detail-text">~3 endpoints</td>
              <td class="effort-days">0.5 days</td>
            </tr>
            <tr>
              <td class="phase-num">11</td>
              <td class="scope-name">Data Migration</td>
              <td class="detail-text">Full production data</td>
              <td class="effort-days">3 &ndash; 4 days</td>
            </tr>
            <tr>
              <td class="phase-num">12</td>
              <td class="scope-name">QA, Hardening &amp; Launch</td>
              <td class="detail-text">E2E + security</td>
              <td class="effort-days">3 &ndash; 4 days</td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <td></td>
              <td>Total Estimated Effort</td>
              <td></td>
              <td class="effort-days">27 &ndash; 35 days</td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>

    <!-- Weekly Plan -->
    <div class="container">
      <div class="section">
        <div class="section-label">Timeline</div>
        <h2>Weekly Execution Plan</h2>
        <p class="section-desc">
          Suggested weekly cadence targeting a 7-week delivery window.
        </p>
        <div class="week-grid">
          <div class="week-label">Week 1</div>
          <div class="week-content">
            <div class="week-phases">
              <span class="week-phase-tag">P0</span>
              <span class="week-phase-tag">P1</span>
              <span class="week-phase-tag">P2</span>
            </div>
            <span class="week-desc"
              >App running, full schema in Postgres, Clerk auth working</span
            >
          </div>
          <div class="week-label">Week 2</div>
          <div class="week-content">
            <div class="week-phases">
              <span class="week-phase-tag">P3</span>
            </div>
            <span class="week-desc"
              >All core CRUD endpoints live &mdash; therapists, clients, orgs,
              admins</span
            >
          </div>
          <div class="week-label">Week 3</div>
          <div class="week-content">
            <div class="week-phases">
              <span class="week-phase-tag">P4</span>
            </div>
            <span class="week-desc"
              >Questionnaire templates, assignment, and answer submission
              working</span
            >
          </div>
          <div class="week-label">Week 4</div>
          <div class="week-content">
            <div class="week-phases">
              <span class="week-phase-tag">P4</span>
              <span class="week-phase-tag">P5</span>
            </div>
            <span class="week-desc"
              >Scoring engine, measurements, protocols, TrueVault replaced</span
            >
          </div>
          <div class="week-label">Week 5</div>
          <div class="week-content">
            <div class="week-phases">
              <span class="week-phase-tag">P6</span>
              <span class="week-phase-tag">P7</span>
            </div>
            <span class="week-desc"
              >Stripe/PayPal payments, scheduling, and screening devices</span
            >
          </div>
          <div class="week-label">Week 6</div>
          <div class="week-content">
            <div class="week-phases">
              <span class="week-phase-tag">P8</span>
              <span class="week-phase-tag">P9</span>
              <span class="week-phase-tag">P10</span>
            </div>
            <span class="week-desc"
              >PDF exports, reports, file storage, cron jobs, analytics</span
            >
          </div>
          <div class="week-label">Week 7</div>
          <div class="week-content">
            <div class="week-phases">
              <span class="week-phase-tag">P11</span>
              <span class="week-phase-tag">P12</span>
            </div>
            <span class="week-desc"
              >Data migration, QA, security hardening, and production
              launch</span
            >
          </div>
        </div>

        <div class="note-box">
          <p>
            <strong>Note:</strong> This timeline assumes AI-assisted development
            with continuous iteration. The critical path runs through Phase 4
            (clinical data) and Phase 11 (data migration), which contain the
            most complex business logic and highest risk of unexpected edge
            cases.
          </p>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="container">
      <div class="footer">
        <div class="footer-line"></div>
        <p>Mentegram API Migration Plan &middot; February 2026</p>
      </div>
    </div>
  </body>
</html>
